<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Hiển thị dữ liệu AppSheet (lọc chính xác)</title>

<style>
body { font-family: Arial; margin: 20px; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 8px; }
th { background: #eee; }
</style>
</head>

<body>

<h2>Hiển thị dữ liệu AppSheet (lọc theo ngày)</h2>

Từ ngày:
<input type="date" id="fromDate">
Đến ngày:
<input type="date" id="toDate">
<button onclick="filterData()">Lọc</button>

<table>
<thead>
<tr>
    <th>KY HIEU HD</th>
    <th>SO HOA DON</th>
    <th>NGAY XUAT HOA DON</th>
</tr>
</thead>
<tbody id="dataBody"></tbody>
</table>

<script>
// ================================
// DỮ LIỆU THẬT GIỐNG APPSHEET
// ================================
const rawData = [
    { kyhieu: "2C24TYY", sohd: "00000324", ngay: "11/01/2024" },
    { kyhieu: "2C24TYY", sohd: "00000325", ngay: "11/01/2024" },
    { kyhieu: "2C24TYY", sohd: "00000326", ngay: "11/01/2024" },
    { kyhieu: "2C24TYY", sohd: "00000327", ngay: "11/05/2024" },
    { kyhieu: "2C24TYY", sohd: "00000328", ngay: "11/06/2024" },
    { kyhieu: "2C24TYY", sohd: "00000329", ngay: "11/06/2024" },
    { kyhieu: "2C24TYY", sohd: "00000330", ngay: "11/06/2024" },
    { kyhieu: "2C24TYY", sohd: "00000331", ngay: "11/07/2024" }
];

// ================================
// CHUYỂN NGÀY DD/MM/YYYY → YYYY-MM-DD
// ================================
function convertDate(d) {
    // AppSheet trả: 11/01/2024 → tách ra
    let parts = d.split("/");
    let DD = parts[0];
    let MM = parts[1];
    let YYYY = parts[2];
    return `${YYYY}-${MM}-${DD}`;
}

// ================================
// HIỂN THỊ BẢNG
// ================================
function renderTable(list) {
    let body = document.getElementById("dataBody");
    body.innerHTML = "";

    list.forEach(r => {
        let tr = document.createElement("tr");
        tr.innerHTML = `
            <td>${r.kyhieu}</td>
            <td>${r.sohd}</td>
            <td>${r.ngay}</td>
        `;
        body.appendChild(tr);
    });
}

// ================================
// LỌC DỮ LIỆU THEO NGÀY
// ================================
function filterData() {
    let f = document.getElementById("fromDate").value;
    let t = document.getElementById("toDate").value;

    if (!f || !t) {
        alert("Bạn phải chọn đủ ngày!");
        return;
    }

    let filtered = rawData.filter(row => {
        let rowDate = new Date(convertDate(row.ngay));  // chuẩn hóa ngày
        let from = new Date(f);
        let to = new Date(t);
        return rowDate >= from && rowDate <= to;
    });

    renderTable(filtered);
}

// HIỆN BAN ĐẦU
renderTable(rawData);
</script>

</body>
</html>
